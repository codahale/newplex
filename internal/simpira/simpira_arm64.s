//go:build arm64 && !nosimd
// +build arm64,!nosimd

#include "textflag.h"

// func permute256(state *[32]byte)
TEXT 路permute256(SB), NOSPLIT, $0
	MOVD state+0(FP), R0
	
	VLD1 (R0), [V0.B16]
	ADD $16, R0, R3
	VLD1 (R3), [V1.B16]
	
	VEOR V6.B16, V6.B16, V6.B16 // zero
	VEOR V7.B16, V7.B16, V7.B16 // increment constant
	
	MOVW $1, R1 // c
	MOVW $2, R2 // b
	
	// Preload increment constant
	MOVD $0x10, R3
	VMOV R3, V7.S[1]
	MOVD $0x20, R3
	VMOV R3, V7.S[2]
	MOVD $0x30, R3
	VMOV R3, V7.S[3]
	
	MOVW $7, R10 // 7 pairs

loop2:
	// Round r (even): x1 ^= F(x0)
	EOR R1, R2, R4 // R4 = c ^ b
	VMOV R4, V4.S4
	VEOR V7.B16, V4.B16, V4.B16 // V4 = C
	
	VORR V0.B16, V0.B16, V5.B16 // V5 = V0
	AESE V6.B16, V5.B16
	AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16
	AESE V6.B16, V5.B16
	AESMC V5.B16, V5.B16
	VEOR V5.B16, V1.B16, V1.B16
	ADD $1, R1
	
	// Round r+1 (odd): x0 ^= F(x1)
	EOR R1, R2, R4
	VMOV R4, V4.S4
	VEOR V7.B16, V4.B16, V4.B16
	
	VORR V1.B16, V1.B16, V5.B16
	AESE V6.B16, V5.B16
	AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16
	AESE V6.B16, V5.B16
	AESMC V5.B16, V5.B16
	VEOR V5.B16, V0.B16, V0.B16
	ADD $1, R1
	
	SUBS $1, R10
	BNE loop2

	// Round 14: x1 ^= F(x0)
	EOR R1, R2, R4
	VMOV R4, V4.S4
	VEOR V7.B16, V4.B16, V4.B16
	
	VORR V0.B16, V0.B16, V5.B16
	AESE V6.B16, V5.B16
	AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16
	AESE V6.B16, V5.B16
	AESMC V5.B16, V5.B16
	VEOR V5.B16, V1.B16, V1.B16
	
	VST1 [V0.B16], (R0)
	ADD $16, R0, R3
	VST1 [V1.B16], (R3)
	RET

// func permute512(state *[64]byte)
TEXT 路permute512(SB), NOSPLIT, $0
	MOVD state+0(FP), R0
	
	VLD1 (R0), [V0.B16]
	ADD $16, R0, R3
	VLD1 (R3), [V1.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V2.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V3.B16]
	
	VEOR V6.B16, V6.B16, V6.B16
	VEOR V7.B16, V7.B16, V7.B16
	MOVW $1, R1 // c
	MOVW $4, R2 // b
	
	MOVD $0x10, R3
	VMOV R3, V7.S[1]
	MOVD $0x20, R3
	VMOV R3, V7.S[2]
	MOVD $0x30, R3
	VMOV R3, V7.S[3]

	MOVW $3, R10 // 3 blocks of 4 rounds
loop4_block:
	// R0
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V0.B16, V0.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V1.B16, V1.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V2.B16, V2.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V3.B16, V3.B16; ADD $1, R1

	// R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V1.B16, V1.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V2.B16, V2.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V3.B16, V3.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V0.B16, V0.B16; ADD $1, R1

	// R2
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V2.B16, V2.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V3.B16, V3.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V0.B16, V0.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V1.B16, V1.B16; ADD $1, R1

	// R3
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V3.B16, V3.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V0.B16, V0.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V1.B16, V1.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V2.B16, V2.B16; ADD $1, R1

	SUBS $1, R10
	BNE loop4_block
	
	// Remaining 3 rounds (R12, R13, R14)
	// R12 (like R0)
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V0.B16, V0.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V1.B16, V1.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V2.B16, V2.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V3.B16, V3.B16; ADD $1, R1
	// R13 (like R1)
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V1.B16, V1.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V2.B16, V2.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V3.B16, V3.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V0.B16, V0.B16; ADD $1, R1
	// R14 (like R2)
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V2.B16, V2.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V3.B16, V3.B16; ADD $1, R1
	EOR R1, R2, R4; VMOV R4, V4.S4; VEOR V7.B16, V4.B16, V4.B16
	VORR V0.B16, V0.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V4.B16, V5.B16, V5.B16; AESE V6.B16, V5.B16; AESMC V5.B16, V5.B16
	VEOR V5.B16, V1.B16, V1.B16; ADD $1, R1

	VST1 [V0.B16], (R0)
	ADD $16, R0, R3
	VST1 [V1.B16], (R3)
	ADD $16, R3, R3
	VST1 [V2.B16], (R3)
	ADD $16, R3, R3
	VST1 [V3.B16], (R3)
	RET


// func permute784(state *[96]byte)
TEXT 路permute784(SB), NOSPLIT, $0
	MOVD state+0(FP), R0
	
	VLD1 (R0), [V0.B16]
	ADD $16, R0, R3
	VLD1 (R3), [V1.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V2.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V3.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V4.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V5.B16]
	
	VEOR V16.B16, V16.B16, V16.B16 // zero
	VEOR V17.B16, V17.B16, V17.B16 // increment constant
	MOVW $1, R1 // c
	MOVW $6, R2 // b
	
	MOVD $0x10, R3
	VMOV R3, V17.S[1]
	MOVD $0x20, R3
	VMOV R3, V17.S[2]
	MOVD $0x30, R3
	VMOV R3, V17.S[3]

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1


	MOVD state+0(FP), R0
	VST1 [V0.B16], (R0)
	ADD $16, R0, R3
	VST1 [V1.B16], (R3)
	ADD $16, R3, R3
	VST1 [V2.B16], (R3)
	ADD $16, R3, R3
	VST1 [V3.B16], (R3)
	ADD $16, R3, R3
	VST1 [V4.B16], (R3)
	ADD $16, R3, R3
	VST1 [V5.B16], (R3)
	RET


// func permute1024(state *[128]byte)
TEXT 路permute1024(SB), NOSPLIT, $0
	MOVD state+0(FP), R0
	
	VLD1 (R0), [V0.B16]
	ADD $16, R0, R3
	VLD1 (R3), [V1.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V2.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V3.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V4.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V5.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V6.B16]
	ADD $16, R3, R3
	VLD1 (R3), [V7.B16]
	
	VEOR V16.B16, V16.B16, V16.B16
	VEOR V17.B16, V17.B16, V17.B16
	MOVW $1, R1 // c
	MOVW $8, R2 // b
	
	MOVD $0x10, R3
	VMOV R3, V17.S[1]
	MOVD $0x20, R3
	VMOV R3, V17.S[2]
	MOVD $0x30, R3
	VMOV R3, V17.S[3]

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V4.B16, V4.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V3.B16, V3.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V2.B16, V2.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V5.B16, V5.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V6.B16, V6.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V1.B16, V1.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V0.B16, V0.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V7.B16, V7.B16
    ADD $1, R1

    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V3.B16, V3.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V0.B16, V0.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V7.B16, V7.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V4.B16, V4.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V5.B16, V5.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V6.B16, V6.B16
    ADD $1, R1
    EOR R1, R2, R4
    VMOV R4, V18.S4
    VEOR V17.B16, V18.B16, V18.B16
    VORR V1.B16, V1.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V18.B16, V19.B16, V19.B16
    AESE V16.B16, V19.B16
    AESMC V19.B16, V19.B16
    VEOR V19.B16, V2.B16, V2.B16
    ADD $1, R1


	MOVD state+0(FP), R0
	VST1 [V0.B16], (R0)
	ADD $16, R0, R3
	VST1 [V1.B16], (R3)
	ADD $16, R3, R3
	VST1 [V2.B16], (R3)
	ADD $16, R3, R3
	VST1 [V3.B16], (R3)
	ADD $16, R3, R3
	VST1 [V4.B16], (R3)
	ADD $16, R3, R3
	VST1 [V5.B16], (R3)
	ADD $16, R3, R3
	VST1 [V6.B16], (R3)
	ADD $16, R3, R3
	VST1 [V7.B16], (R3)
	RET

